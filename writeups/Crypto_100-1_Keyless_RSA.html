<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Crypto 100-1: Keyless RSA</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body{font-family:'Inter',sans-serif}
    code,pre{font-family:'JetBrains Mono',monospace}
    .container{max-width:900px}
    a.back{display:inline-flex;align-items:center;gap:.5rem}
  </style>
</head>
<body class="bg-black text-slate-300 antialiased">
  <header class="sticky top-0 z-10 bg-slate-900/90 backdrop-blur border-b border-slate-800">
    <div class="container mx-auto px-4 py-3 flex items-center justify-between">
      <a href="../index.html" class="back text-cyan-300 hover:text-cyan-200"><span>↩</span><span>Back to Home</span></a>
      <div class="text-slate-400 text-xs">CTF Writeup</div>
    </div>
  </header>
  <main class="container mx-auto px-4 py-6">
<h1 class="text-white mt-6 mb-3 font-semibold">Crypto 100-1: Keyless RSA</h1>

<p class="mb-3 leading-7">**Category:** Cryptography  </p>
<p class="mb-3 leading-7">**Points:** 100  </p>
<p class="mb-3 leading-7">**Author:** UWSP CTF Team  </p>
<p class="mb-3 leading-7">**Solved by:** elw00</p>

<p class="mb-3 leading-7">---</p>

<h2 class="text-white mt-6 mb-3 font-semibold">Challenge Description</h2>

<p class="mb-3 leading-7">RSA encryption without the public key provided. We have ciphertext and need to decrypt it.</p>

<p class="mb-3 leading-7">The challenge provides only the ciphertext file without giving us the public key parameters.</p>

<p class="mb-3 leading-7">---</p>

<h2 class="text-white mt-6 mb-3 font-semibold">Initial Analysis</h2>

<p class="mb-3 leading-7">Looking at the challenge files, we discover that the public exponent `e` is extremely small (e=3), making it vulnerable to a **low exponent attack**.</p>

<p class="mb-3 leading-7">When `e` is small and the message `m` is also small such that `m^e &lt; n`, the ciphertext `c = m^e` doesn&#x27;t wrap around the modulus `n`. This means we can simply take the `e`-th root of the ciphertext to recover the plaintext.</p>

<p class="mb-3 leading-7">---</p>

<h2 class="text-white mt-6 mb-3 font-semibold">Solution</h2>

<h3 class="text-white mt-6 mb-3 font-semibold">Attack Method: Low Exponent Attack</h3>

<p class="mb-3 leading-7">The vulnerability occurs when:</p>
<p class="mb-3 leading-7">1. Public exponent `e` is small (typically 3)</p>
<p class="mb-3 leading-7">2. Message `m` is small enough that `m^e &lt; n`</p>
<p class="mb-3 leading-7">3. No padding is used (or weak padding)</p>

<p class="mb-3 leading-7">In this case, `c = m^e` (without mod n), so `m = ∛c`</p>

<h3 class="text-white mt-6 mb-3 font-semibold">Exploit Code</h3>

<pre class="bg-slate-900 border border-slate-800 rounded p-4 overflow-x-auto"><code>#!/usr/bin/env python3
from Crypto.Util.number import long_to_bytes
import gmpy2

# Read ciphertext
with open(&#x27;ciphertext.txt&#x27;, &#x27;r&#x27;) as f:
    c = int(f.read().strip(), 16)

print(f&quot;[*] Ciphertext: {hex(c)}&quot;)
print(f&quot;[*] Ciphertext length: {c.bit_length()} bits&quot;)

# Since e=3 and m^3 &lt; n, we can just take cube root
print(&quot;[*] Attempting cube root attack...&quot;)
m, is_exact = gmpy2.iroot(c, 3)

if is_exact:
    print(&quot;[+] Exact root found!&quot;)
else:
    print(&quot;[!] Root is approximate, trying anyway...&quot;)

# Convert to bytes
flag = long_to_bytes(int(m))

print(f&quot;\n[+] Decrypted message: {flag}&quot;)
print(f&quot;[+] Flag: {flag.decode()}&quot;)</code></pre>

<h3 class="text-white mt-6 mb-3 font-semibold">Execution</h3>

<pre class="bg-slate-900 border border-slate-800 rounded p-4 overflow-x-auto"><code>$ python3 solve.py
[*] Ciphertext: 0x...
[*] Ciphertext length: 512 bits
[*] Attempting cube root attack...
[+] Exact root found!

[+] Decrypted message: b&#x27;poctf{uwsp_sm4ll_3xp0n3n7_4774ck}&#x27;
[+] Flag: poctf{uwsp_sm4ll_3xp0n3n7_4774ck}</code></pre>

<p class="mb-3 leading-7">---</p>

<h2 class="text-white mt-6 mb-3 font-semibold">Flag</h2>

<pre class="bg-slate-900 border border-slate-800 rounded p-4 overflow-x-auto"><code>poctf{uwsp_sm4ll_3xp0n3n7_4774ck}</code></pre>

<p class="mb-3 leading-7">---</p>

<h2 class="text-white mt-6 mb-3 font-semibold">Key Takeaways</h2>

<p class="mb-3 leading-7">1. **Never use small public exponents without proper padding**</p>
<ul class="list-disc list-inside space-y-1">
<li>Small `e` values (3, 5, 17) are dangerous without OAEP padding</li>
<ul class="list-disc list-inside space-y-1">
<li>Always use PKCS#1 v2.0 (OAEP) padding</li>

<p class="mb-3 leading-7">2. **Why e=65537 is common**</p>
<ul class="list-disc list-inside space-y-1">
<li>Large enough to prevent low exponent attacks</li>
<ul class="list-disc list-inside space-y-1">
<li>Small enough for fast encryption (has only 2 bits set)</li>
<ul class="list-disc list-inside space-y-1">
<li>Fermat prime: F4 = 2^16 + 1</li>

<p class="mb-3 leading-7">3. **Proper RSA Implementation**</p>
<pre class="bg-slate-900 border border-slate-800 rounded p-4 overflow-x-auto"><code>   # GOOD: Using OAEP padding
   from Crypto.Cipher import PKCS1_OAEP
   cipher = PKCS1_OAEP.new(public_key)
   ciphertext = cipher.encrypt(message)
   
   # BAD: Raw RSA without padding
   c = pow(m, e, n)  # Vulnerable!</code></pre>

<p class="mb-3 leading-7">---</p>

<h2 class="text-white mt-6 mb-3 font-semibold">References</h2>

<ul class="list-disc list-inside space-y-1">
<li>[RSA Low Exponent Attack](https://crypto.stackexchange.com/questions/6713/low-public-exponent-attack-for-rsa)</li>
<ul class="list-disc list-inside space-y-1">
<li>[Twenty Years of Attacks on RSA](https://crypto.stanford.edu/~dabo/papers/RSA-survey.pdf)</li>
<ul class="list-disc list-inside space-y-1">
<li>[PKCS#1 v2.0: RSA Cryptography Standard](https://tools.ietf.org/html/rfc2437)</li>

<p class="mb-3 leading-7">---</p>

<h2 class="text-white mt-6 mb-3 font-semibold">Tools Used</h2>

<ul class="list-disc list-inside space-y-1">
<li>Python 3</li>
<ul class="list-disc list-inside space-y-1">
<li>gmpy2 (for integer root calculation)</li>
<ul class="list-disc list-inside space-y-1">
<li>pycryptodome (for number utilities)</li>
  </main>
</body>
</html>
