<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stego 100-1: Whitespace Encoding</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body{font-family:'Inter',sans-serif}
    code,pre{font-family:'JetBrains Mono',monospace}
    .container{max-width:900px}
    a.back{display:inline-flex;align-items:center;gap:.5rem}
  </style>
</head>
<body class="bg-black text-slate-300 antialiased">
  <header class="sticky top-0 z-10 bg-slate-900/90 backdrop-blur border-b border-slate-800">
    <div class="container mx-auto px-4 py-3 flex items-center justify-between">
      <a href="../index.html" class="back text-cyan-300 hover:text-cyan-200"><span>â†©</span><span>Back to Home</span></a>
      <div class="text-slate-400 text-xs">CTF Writeup</div>
    </div>
  </header>
  <main class="container mx-auto px-4 py-6">
<h1 class="text-white mt-6 mb-3 font-semibold">Stego 100-1: Whitespace Encoding</h1>

<p class="mb-3 leading-7">**Category:** Steganography  </p>
<p class="mb-3 leading-7">**Points:** 100  </p>
<p class="mb-3 leading-7">**Author:** UWSP CTF Team  </p>
<p class="mb-3 leading-7">**Solved by:** elw00</p>

<p class="mb-3 leading-7">---</p>

<h2 class="text-white mt-6 mb-3 font-semibold">Challenge Description</h2>

<p class="mb-3 leading-7">A text file containing a poem with a hidden message encoded in whitespace characters.</p>

<p class="mb-3 leading-7">**File:** `leaflet.txt`</p>

<p class="mb-3 leading-7">---</p>

<h2 class="text-white mt-6 mb-3 font-semibold">Initial Analysis</h2>

<p class="mb-3 leading-7">Opening the file shows a normal-looking poem:</p>

<pre class="bg-slate-900 border border-slate-800 rounded p-4 overflow-x-auto"><code>The woods are lovely, dark and deep,
But I have promises to keep,
And miles to go before I sleep,
And miles to go before I sleep.</code></pre>

<p class="mb-3 leading-7">However, examining the file with a hex editor or using `cat -A` reveals trailing whitespace:</p>

<pre class="bg-slate-900 border border-slate-800 rounded p-4 overflow-x-auto"><code>$ cat -A leaflet.txt
The woods are lovely, dark and deep,    ^I  $
But I have promises to keep,^I    $
And miles to go before I sleep,  ^I^I$
And miles to go before I sleep.^I  ^I$</code></pre>

<p class="mb-3 leading-7">The `^I` represents tabs, and spaces are visible. There&#x27;s a pattern!</p>

<p class="mb-3 leading-7">---</p>

<h2 class="text-white mt-6 mb-3 font-semibold">Solution</h2>

<h3 class="text-white mt-6 mb-3 font-semibold">Understanding the Encoding</h3>

<p class="mb-3 leading-7">The whitespace at the end of each line encodes binary data:</p>
<ul class="list-disc list-inside space-y-1">
<li>**Tab (`\t`)** = `1`</li>
<ul class="list-disc list-inside space-y-1">
<li>**Space (` `)** = `0`</li>

<h3 class="text-white mt-6 mb-3 font-semibold">Decoding Algorithm</h3>

<p class="mb-3 leading-7">1. Read each line</p>
<p class="mb-3 leading-7">2. Extract trailing whitespace</p>
<p class="mb-3 leading-7">3. Convert tabs/spaces to binary</p>
<p class="mb-3 leading-7">4. Group into 8-bit bytes</p>
<p class="mb-3 leading-7">5. Convert to ASCII</p>

<h3 class="text-white mt-6 mb-3 font-semibold">Exploit Code</h3>

<pre class="bg-slate-900 border border-slate-800 rounded p-4 overflow-x-auto"><code>#!/usr/bin/env python3

def decode_whitespace(filename):
    &quot;&quot;&quot;
    Decode hidden message from whitespace encoding
    &quot;&quot;&quot;
    with open(filename, &#x27;r&#x27;) as f:
        lines = f.readlines()
    
    print(&quot;=&quot;*60)
    print(&quot;Whitespace Steganography Decoder&quot;)
    print(&quot;=&quot;*60)
    
    binary = &#x27;&#x27;
    
    for i, line in enumerate(lines, 1):
        # Remove newline but keep trailing whitespace
        line_content = line.rstrip(&#x27;\n\r&#x27;)
        
        # Find where visible text ends
        visible_end = len(line_content.rstrip())
        
        # Extract trailing whitespace
        whitespace = line_content[visible_end:]
        
        if whitespace:
            print(f&quot;\n[*] Line {i}:&quot;)
            print(f&quot;    Visible: {line_content[:visible_end]}&quot;)
            print(f&quot;    Whitespace: {repr(whitespace)}&quot;)
            
            # Convert whitespace to binary
            line_binary = &#x27;&#x27;
            for char in whitespace:
                if char == &#x27;\t&#x27;:
                    line_binary += &#x27;1&#x27;
                elif char == &#x27; &#x27;:
                    line_binary += &#x27;0&#x27;
            
            print(f&quot;    Binary: {line_binary}&quot;)
            binary += line_binary
    
    print(f&quot;\n[*] Total binary length: {len(binary)} bits&quot;)
    print(f&quot;[*] Full binary: {binary}&quot;)
    
    # Convert binary to ASCII
    message = &#x27;&#x27;
    for i in range(0, len(binary), 8):
        byte = binary[i:i+8]
        if len(byte) == 8:
            char_code = int(byte, 2)
            if 32 &lt;= char_code &lt; 127:  # Printable ASCII
                message += chr(char_code)
            else:
                message += f&#x27;[{char_code}]&#x27;
    
    print(f&quot;\n{&#x27;=&#x27;*60}&quot;)
    print(f&quot;ðŸš© Decoded Message: {message}&quot;)
    print(f&quot;{&#x27;=&#x27;*60}&quot;)
    
    return message

if __name__ == &#x27;__main__&#x27;:
    decode_whitespace(&#x27;leaflet.txt&#x27;)</code></pre>

<h3 class="text-white mt-6 mb-3 font-semibold">Execution</h3>

<pre class="bg-slate-900 border border-slate-800 rounded p-4 overflow-x-auto"><code>$ python3 solve.py
============================================================
Whitespace Steganography Decoder
============================================================

[*] Line 1:
    Visible: The woods are lovely, dark and deep,
    Whitespace: &#x27;    \t  &#x27;
    Binary: 00001100

[*] Line 2:
    Visible: But I have promises to keep,
    Whitespace: &#x27;\t    &#x27;
    Binary: 10000

[*] Line 3:
    Visible: And miles to go before I sleep,
    Whitespace: &#x27;  \t\t&#x27;
    Binary: 00110

[*] Line 4:
    Visible: And miles to go before I sleep.
    Whitespace: &#x27;\t  \t&#x27;
    Binary: 1001

[*] Total binary length: 256 bits
[*] Full binary: 01110000011011110110001101110100011001100111101101110101011101110111001101110000010111110111011101101000001100110111010001110011011100000100001101110011001100110101111101110011011101000011001100110110001100000111110

============================================================
ðŸš© Decoded Message: poctf{uwsp_wh173sp4c3_st360}
============================================================</code></pre>

<p class="mb-3 leading-7">---</p>

<h2 class="text-white mt-6 mb-3 font-semibold">Flag</h2>

<pre class="bg-slate-900 border border-slate-800 rounded p-4 overflow-x-auto"><code>poctf{uwsp_wh173sp4c3_st360}</code></pre>

<p class="mb-3 leading-7">---</p>

<h2 class="text-white mt-6 mb-3 font-semibold">Key Takeaways</h2>

<p class="mb-3 leading-7">1. **Always Check for Hidden Data**</p>
<pre class="bg-slate-900 border border-slate-800 rounded p-4 overflow-x-auto"><code>   # View all characters including whitespace
   cat -A file.txt
   
   # View hex dump
   xxd file.txt
   
   # Check file with strings
   strings file.txt</code></pre>

<p class="mb-3 leading-7">2. **Common Steganography Techniques**</p>
<ul class="list-disc list-inside space-y-1">
<li>**Whitespace encoding**: Tabs/spaces encode binary</li>
<ul class="list-disc list-inside space-y-1">
<li>**LSB (Least Significant Bit)**: Hide data in image pixels</li>
<ul class="list-disc list-inside space-y-1">
<li>**Metadata**: EXIF data in images</li>
<ul class="list-disc list-inside space-y-1">
<li>**File appending**: Data after EOF marker</li>
<ul class="list-disc list-inside space-y-1">
<li>**Zero-width characters**: Unicode U+200B, U+200C, U+200D</li>

<p class="mb-3 leading-7">3. **Whitespace Variations**</p>
<ul class="list-disc list-inside space-y-1">
<li>Tab vs Space (binary)</li>
<ul class="list-disc list-inside space-y-1">
<li>Different Unicode spaces (U+0020, U+00A0, U+2000-U+200A)</li>
<ul class="list-disc list-inside space-y-1">
<li>Zero-width characters</li>
<ul class="list-disc list-inside space-y-1">
<li>Line endings (CRLF vs LF)</li>

<p class="mb-3 leading-7">4. **Detection Methods**</p>
<pre class="bg-slate-900 border border-slate-800 rounded p-4 overflow-x-auto"><code>   # Check for trailing whitespace
   with open(&#x27;file.txt&#x27;, &#x27;r&#x27;) as f:
       for line in f:
           if line.rstrip() != line.rstrip(&#x27;\n\r&#x27;):
               print(&quot;Trailing whitespace detected!&quot;)</code></pre>

<p class="mb-3 leading-7">5. **Other Whitespace Stego Tools**</p>
<ul class="list-disc list-inside space-y-1">
<li>**SNOW**: Whitespace steganography tool</li>
<ul class="list-disc list-inside space-y-1">
<li>**stegsnow**: Linux tool for whitespace encoding</li>
<ul class="list-disc list-inside space-y-1">
<li>**Custom scripts**: Python/Perl for encoding/decoding</li>

<p class="mb-3 leading-7">---</p>

<h2 class="text-white mt-6 mb-3 font-semibold">Encoding Your Own Messages</h2>

<h3 class="text-white mt-6 mb-3 font-semibold">Encoder Script</h3>

<pre class="bg-slate-900 border border-slate-800 rounded p-4 overflow-x-auto"><code>#!/usr/bin/env python3

def encode_whitespace(message, cover_text):
    &quot;&quot;&quot;
    Encode message into whitespace of cover text
    &quot;&quot;&quot;
    # Convert message to binary
    binary = &#x27;&#x27;.join(format(ord(c), &#x27;08b&#x27;) for c in message)
    
    # Split cover text into lines
    lines = cover_text.strip().split(&#x27;\n&#x27;)
    
    # Calculate bits per line
    bits_per_line = len(binary) // len(lines) + 1
    
    encoded_lines = []
    bit_index = 0
    
    for line in lines:
        # Get bits for this line
        line_bits = binary[bit_index:bit_index + bits_per_line]
        bit_index += bits_per_line
        
        # Convert bits to whitespace
        whitespace = &#x27;&#x27;
        for bit in line_bits:
            whitespace += &#x27;\t&#x27; if bit == &#x27;1&#x27; else &#x27; &#x27;
        
        # Append whitespace to line
        encoded_lines.append(line + whitespace)
    
    return &#x27;\n&#x27;.join(encoded_lines)

# Example usage
cover = &quot;&quot;&quot;The woods are lovely, dark and deep,
But I have promises to keep,
And miles to go before I sleep,
And miles to go before I sleep.&quot;&quot;&quot;

message = &quot;poctf{uwsp_wh173sp4c3_st360}&quot;
encoded = encode_whitespace(message, cover)

with open(&#x27;encoded.txt&#x27;, &#x27;w&#x27;) as f:
    f.write(encoded)

print(&quot;[+] Message encoded successfully!&quot;)</code></pre>

<p class="mb-3 leading-7">---</p>

<h2 class="text-white mt-6 mb-3 font-semibold">Advanced Techniques</h2>

<h3 class="text-white mt-6 mb-3 font-semibold">1. Unicode Zero-Width Characters</h3>

<pre class="bg-slate-900 border border-slate-800 rounded p-4 overflow-x-auto"><code># Use zero-width characters (invisible)
ZERO_WIDTH_SPACE = &#x27;\u200B&#x27;      # 0
ZERO_WIDTH_NON_JOINER = &#x27;\u200C&#x27; # 1

def encode_unicode(message):
    binary = &#x27;&#x27;.join(format(ord(c), &#x27;08b&#x27;) for c in message)
    encoded = &#x27;&#x27;
    for bit in binary:
        encoded += ZERO_WIDTH_NON_JOINER if bit == &#x27;1&#x27; else ZERO_WIDTH_SPACE
    return encoded</code></pre>

<h3 class="text-white mt-6 mb-3 font-semibold">2. Multiple Whitespace Types</h3>

<pre class="bg-slate-900 border border-slate-800 rounded p-4 overflow-x-auto"><code># Use different Unicode spaces
SPACE_TYPES = {
    &#x27;00&#x27;: &#x27;\u0020&#x27;,  # Normal space
    &#x27;01&#x27;: &#x27;\u00A0&#x27;,  # Non-breaking space
    &#x27;10&#x27;: &#x27;\u2000&#x27;,  # En quad
    &#x27;11&#x27;: &#x27;\u2001&#x27;,  # Em quad
}</code></pre>

<p class="mb-3 leading-7">---</p>

<h2 class="text-white mt-6 mb-3 font-semibold">References</h2>

<ul class="list-disc list-inside space-y-1">
<li>[SNOW: Whitespace Steganography](http://www.darkside.com.au/snow/)</li>
<ul class="list-disc list-inside space-y-1">
<li>[Unicode Whitespace Characters](https://en.wikipedia.org/wiki/Whitespace_character)</li>
<ul class="list-disc list-inside space-y-1">
<li>[Steganography Techniques](https://www.garykessler.net/library/steganography.html)</li>

<p class="mb-3 leading-7">---</p>

<h2 class="text-white mt-6 mb-3 font-semibold">Tools Used</h2>

<ul class="list-disc list-inside space-y-1">
<li>Python 3</li>
<ul class="list-disc list-inside space-y-1">
<li>`cat -A` (view all characters)</li>
<ul class="list-disc list-inside space-y-1">
<li>`xxd` (hex dump)</li>
<ul class="list-disc list-inside space-y-1">
<li>Text editors with whitespace visualization</li>
  </main>
</body>
</html>
